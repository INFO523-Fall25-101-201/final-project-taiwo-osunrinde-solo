---
title: "Cancer Prediction in patients using Convolutional Neural Network, Logistic Regression, and Random Forest Algorithms"
author: "Taiwo Osunrinde (Solo)"

title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: cover
  data-background-opacity: "0.6"
  data-slide-number: none

format:
  revealjs:
    theme: 
      - default
      - data/customtheming.scss   # custom theme now loads correctly
    slide-number: true
    transition: slide
    center: false
    footer: "INFO-523 | Cancer Prediction"
    width: 1200            
    height: 1300            
    margin: 0.05            

editor: visual
jupyter: python3

execute:
  echo: false
---

## Introduction

### Project: Cancer Prediction using CNN, LR, and RF Machine Learning Algorithm

-   **Objective:** To build a machine learning model that accurately predicts the presence of cancer in patients.
-   **Key Questions Addressed:**
    1.  What are the factors contributing to cancer development in these patients?
    2.  Which of these models will accurately predict the presence of cancer in these patients?
    3.  

## Data Overview & Setup

### Dataset: Cancer Prediction dataset

-   **Source:** Kaggle (https://www.kaggle.com/datasets/rabieelkharoua/cancer-prediction-dataset)
-   **Features:** Age, Gender, BMI, Smoking, GeneticRisk, PhysicalActivity, AlcoholIntake, CancerHistory.
-   **Target Variable:** `Diagnosis`.

## Methodology
1. Data cleaning
2. Exploratory data Analysis
3. Feature importance and Engineering
4. Split data into train, test, and validation
5. Model development (CNN, Logistic Regression, and Random Forests)
6. Model testing and validation

```{python,data-v-align="top"}
#| label: load-pkgs
#| message: false
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
#| label: load-dataset
#| message: false
data = pd.read_csv('data/The_Cancer_data_1500_V2.csv')
data.head(5)
data.info()

```

------------------------------------------------------------------------

## Exploratory Data Analysis

### Histogram Plot

| Histogram distribution of each data | 
|:----------------------------------:|
| ![](images/data_distribution.png) | 
| *Observation: The data is evenly distributed and cleaned. No further preprocessing is required* | 


------------------------------------------------------------------------

### Impacts of each variable on cancer detection

#### Alcohol Intake and Physical Activity

|------------------------------------------------------------------------|
| ![](images/alcohol_physical_activity_scatter.png)  |

Impact: The scatter plot above shows that physical activity and alcohol intake cause cancer. However, it is not clear to what extent since there is no clear distinction on the plot. We will investigate this further. \|

#### Alcohol Intake, Physical Activity, and Genetic Risk

|------------------------------------------------------------------------|
| ![](images/alcohol_physical_activity_genetic_scatter.png)  |

Impact: From the plot above, it can be noted that people with high genetic risk are prone to cancer even if they don't take alcohol or are physically fit. People with low genetic risk have a smaller chance of getting cancer. \|

#### Smoking and Diagnosis

|------------------------------------------------------------------------|
| ![](images/smoking_diagnosis.png)  |

Impact: This indicates that the number of people who smoke and have cancer and the people who smoke and don't have cancer are almost the same. Also, the number of people who don't smoke but have cancer is higher than the number of people who smoke and have cancer. Hence, we can't conclude if smoking is a direct indicator of cancer. \|


#### Gender and Diagnosis

|------------------------------------------------------------------------|
| ![](images/gender_diagnosis.png)  |

Impact: The plot above implies that about 1/3 of the female population has cancer, while the number of males with or without cancer is equal. \|


## Modeling Approach

- Split data to train/test (80/20)
- Split train data for training and validation (80/20)
  -   **Goal:** To ensure the test data is not exposed/leaked during training.
-   **Model Chosen:** **Random Forest Regressor and Logistic Regressor (Soft voting classifier approach)** (highest predictive power).
-   **Evaluation:** Accuracy, Precision, Recall, and f1_score.

## Voting Classifier (Random Forest and Logistic Regressor) Performance

### Model Accuracy 

| | Metric | Value | 
| :--- | :--- | 
| **Accuracy** | **0.93** |
| **Precision** | **0.92**  | 
| **Recall** | **0.89**  | 
| **f1_score** | **0.90** | 

## Top features
The model identified the most critical features impacting price:
1.  **Age** (Engineered Feature)
2.  **Smoking**
3.  **GeneticRisk**
4.  **BWI**
5.  **Gender**

------------------------------------------------------------------------


*Technical Detail:* A model pipeline was created to use two estimators via an approach called **Voting Classifier**. The trained model was serialized and saved as `cancer_model.pkl`.  This was later deployed via a web dashboard.

## Deployment
* **Website:** https://cancerapps.streamlit.app/

## Conclusion: Summary of Findings
The analysis showed that Genetic risk, BWi, gender, physical activity, and smoking all contribute to whether a patient will have cancer or not. The three models used for training performed well on the data.  There was no overfitting or underfitting noticed. Combining two models is also a good way to ensure the model is not overfitting.

## Recommendations

1.  More data needs to be utilized. 1500 samples are not sufficient to build a good-performing model.
2.  More factors also need to be considered.
3.  Cancer Images should be used alongside the tabular data when training  the convolutional neural network model.

## Thanks for listening
